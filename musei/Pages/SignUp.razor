@using Radzen
@using musei.Data
@inject CosmosService cs
@inject Session sess
@page "/signup"

<style>
    body {
        padding: 20px;
    }

    .bottom {
        position: absolute;
        bottom: 40px;
        right: 40px;
        text-align: right;
    }
</style>

<body>
    <div>
        <RadzenText TextStyle="TextStyle.H3"
                    TextAlign="TextAlign.Center" Style="color: #F52D11"><strong>Musei Fantastici</strong></RadzenText>
        <RadzenText TextStyle="TextStyle.Body1" TextAlign="TextAlign.Center">Welcome to our community!</RadzenText>
        <div>
            <RadzenCard Class="rz-border-base-0 rz-shadow-0" Style="margin-top: 20px">
                <RadzenTextBox Style="border-radius: 10px; margin-bottom: 10px" Placeholder="Full Name" @bind-Value=@newUser.name Class="w-100" />
                <RadzenDatePicker Class="w-100" Style="border-radius: 10px; margin-bottom: 10px" Placeholder="Birthday" @bind-Value=@value DateFormat="d" />
                <RadzenTextBox Style="border-radius: 10px; margin-bottom: 10px" Placeholder="Email" @bind-Value=@newUser.id Class="w-100" />
                <RadzenPassword Style="border-radius: 10px; margin-bottom: 10px" Placeholder="Password" @bind-Value=@newUser.password Class="w-100" />
            </RadzenCard>
            <RadzenButton Click=@(args => OnClickSignup()) Text="Sign Up" Style="width: 100%;"
                          ButtonStyle="ButtonStyle.Danger" Variant="Variant.Flat" />
        </div>
        <div class="bottom">
            <RadzenText Style="color: #F52D11">Already a Member?</RadzenText>
            <RadzenButton Variant="Variant.Text" ButtonStyle="ButtonStyle.Danger" Click=@(args => OnClickLogin()) Text="Log In"/>
        </div>
    </div>
</body>

@code {
    public User newUser = new User();

    DateTime? value = DateTime.Now;

    async void OnClickSignup()
    {
        newUser.birthDate = (DateTime)value;
        await cs.UpsertUser(newUser);
        sess.currentUser = newUser;
        await App.Current.MainPage.Navigation.PushAsync(new xHomePage());
    }

    async void OnClickLogin()
    {
        await App.Current.MainPage.Navigation.PushAsync(new xAccount());
    }
}